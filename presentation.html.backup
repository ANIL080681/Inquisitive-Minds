<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Homework Assistant - Presentation</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
      background: #1a1a2e;
      color: #fff;
      overflow: hidden;
    }

    .slide {
      display: none;
      width: 100vw;
      height: 100vh;
      padding: 60px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      align-items: center;
      justify-content: flex-start;
      flex-direction: column;
      text-align: center;
      overflow-y: auto;
      overflow-x: hidden;
      position: relative;
    }

    .slide.active {
      display: flex;
    }

    h1 {
      font-size: 4em;
      margin-bottom: 30px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    h2 {
      font-size: 2.5em;
      margin-bottom: 20px;
      color: #fff;
    }

    h3 {
      font-size: 2em;
      margin-bottom: 15px;
      color: #f0f0f0;
    }

    p, li {
      font-size: 1.5em;
      line-height: 1.6;
      max-width: 900px;
      margin: 0 auto 20px;
    }

    .author-info {
      margin-top: 40px;
      padding: 30px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }

    .author-info p {
      margin: 10px 0;
      font-size: 1.3em;
    }

    .emoji {
      font-size: 1.5em;
      margin-right: 10px;
    }

    .controls {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      gap: 15px;
      z-index: 1000;
    }

    button {
      padding: 15px 30px;
      font-size: 1.2em;
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid white;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      backdrop-filter: blur(10px);
      transition: all 0.3s;
    }

    button:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    .slide-number {
      position: fixed;
      bottom: 30px;
      left: 30px;
      font-size: 1.2em;
      color: white;
      background: rgba(0, 0, 0, 0.3);
      padding: 10px 20px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }

    .progress-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 6px;
      background: rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      transition: width 0.4s ease;
      box-shadow: 0 0 10px rgba(102, 126, 234, 0.8);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
      margin-top: 30px;
      max-width: 1200px;
    }

    .feature-card {
      background: rgba(255, 255, 255, 0.1);
      padding: 30px;
      border-radius: 15px;
      backdrop-filter: blur(10px);
      transition: transform 0.3s;
    }

    .feature-card:hover {
      transform: translateY(-5px);
    }

    ul {
      text-align: left;
      max-width: 800px;
      margin: 20px auto;
    }

    li {
      margin: 15px 0;
      list-style-position: inside;
    }

    .signin-form-demo {
      background: rgba(255, 255, 255, 0.15);
      padding: 40px;
      border-radius: 20px;
      backdrop-filter: blur(10px);
      max-width: 500px;
      margin: 30px auto;
    }

    .form-field {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-field label {
      display: block;
      font-size: 1.2em;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .form-field input {
      width: 100%;
      padding: 15px;
      font-size: 1.1em;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      backdrop-filter: blur(5px);
    }

    .form-field input::placeholder {
      color: rgba(255, 255, 255, 0.7);
    }

    .demo-button {
      width: 100%;
      margin-top: 20px;
      padding: 18px;
      font-size: 1.3em;
      background: rgba(255, 255, 255, 0.3);
      border: 2px solid white;
      color: white;
      border-radius: 12px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
    }

    .demo-button:hover {
      background: rgba(255, 255, 255, 0.4);
      transform: scale(1.02);
    }
  </style>
</head>
<body>
  <!-- Slide 1: Homepage -->
  <div class="slide active">
    <h1>üìö Homework Assistant</h1>
    <h2>Your AI-Powered Study Companion</h2>
    <p>An intelligent homework helper that solves Math, English, and Science problems with detailed explanations</p>
    
    <div class="author-info">
      <h3>Created By</h3>
      <p><span class="emoji">üë§</span><strong>Author:</strong> Nimit</p>
    </div>
    
    <div style="margin-top: 40px; padding: 25px; background: rgba(255, 255, 255, 0.15); border-radius: 15px; backdrop-filter: blur(10px); border: 2px solid rgba(255, 255, 255, 0.3);">
      <h3 style="font-size: 2em; margin-bottom: 10px;">üí∞ Only $15</h3>
      <p style="font-size: 1.3em;">Get unlimited access to all subjects and features</p>
    </div>
    
    <div style="margin-top: 30px; padding: 20px; background: rgba(100, 255, 100, 0.2); border-radius: 12px; border: 2px solid rgba(150, 255, 150, 0.5); max-width: 800px;">
      <h3 style="font-size: 1.5em; margin-bottom: 12px;">ü§ñ AI-Powered</h3>
      <p style="font-size: 1em; text-align: left; line-height: 1.6;">
        <strong>‚ú® Now with Google Gemini AI:</strong><br>
        ‚úÖ Complex word problems & multi-step reasoning<br>
        ‚úÖ Essay writing help & creative compositions<br>
        ‚úÖ Reading comprehension & analysis<br>
        ‚úÖ Advanced math (algebra, geometry, calculus prep)<br>
        ‚úÖ Science experiments & lab questions<br>
        ‚úÖ Detailed step-by-step explanations<br>
        <br>
        <strong>üí° Smart system:</strong> Uses pattern matching first (instant), falls back to AI for complex problems
      </p>
    </div>
  </div>

  <!-- Slide 2: Sign In Page -->
  <div class="slide">
    <h1>üîê Sign In / Sign Up</h1>
    <h2>Create Your Account</h2>
    
    <div class="signin-form-demo">
      <div class="form-field">
        <label>üìß Email</label>
        <input type="email" placeholder="student@example.com" onkeypress="if(event.key==='Enter') handleSignUp()">
      </div>
      
      <div class="form-field">
        <label>üîí Password</label>
        <div style="position: relative;">
          <input id="password-field" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="padding-right: 50px;" onkeypress="if(event.key==='Enter') handleSignUp()">
          <span onclick="togglePassword()" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; font-size: 1.3em; user-select: none;">üëÅÔ∏è</span>
        </div>
      </div>
      
      <div class="form-field">
        <label>üéÇ Date of Birth</label>
        <input type="date" value="2015-01-15" onkeypress="if(event.key==='Enter') handleSignUp()">
      </div>
      
      <div class="form-field">
        <label>üìö Class/Grade</label>
        <input type="text" placeholder="Grade 5" onkeypress="if(event.key==='Enter') handleSignUp()">
      </div>
      
      <div class="form-field">
        <label>üè´ School Name</label>
        <input type="text" placeholder="Springfield Elementary" onkeypress="if(event.key==='Enter') handleSignUp()">
      </div>
      
      <div class="form-field">
        <label>üë§ Account Type</label>
        <select id="role" style="width: 100%; padding: 15px; font-size: 1.1em; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(255, 255, 255, 0.9); color: #333;">
          <option value="student">Student</option>
          <option value="teacher">Teacher</option>
          <option value="admin">Admin</option>
        </select>
      </div>
      
      <button class="demo-button" onclick="handleSignUp()">Sign Up üöÄ</button>
    </div>
    
    <p style="margin-top: 30px; font-size: 1.2em;">‚úì Age verification for safety (5+ years old)</p>
  </div>

  <!-- Slide 3: Student Dashboard -->
  <div class="slide" id="studentSlide">
    <h1>‚ùì Ask Your Questions</h1>
    <h2>Get Help with Any Subject</h2>
    
    <!-- Progress Stats Card -->
    <div style="margin-bottom: 20px; padding: 20px; background: rgba(255, 255, 255, 0.15); border-radius: 15px; max-width: 900px;">
      <h3 style="margin-bottom: 15px;">üìä Your Progress</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; text-align: center;">
        <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 10px;">
          <p style="font-size: 2.5em; margin: 0;" id="totalQuestions">0</p>
          <p style="font-size: 1em; margin: 5px 0 0 0;">Total Questions</p>
        </div>
        <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 10px;">
          <p style="font-size: 2.5em; margin: 0;" id="mathCount">0</p>
          <p style="font-size: 1em; margin: 5px 0 0 0;">Math</p>
        </div>
        <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 10px;">
          <p style="font-size: 2.5em; margin: 0;" id="englishCount">0</p>
          <p style="font-size: 1em; margin: 5px 0 0 0;">English</p>
        </div>
        <div style="background: rgba(255, 255, 255, 0.1); padding: 15px; border-radius: 10px;">
          <p style="font-size: 2.5em; margin: 0;" id="scienceCount">0</p>
          <p style="font-size: 1em; margin: 5px 0 0 0;">Science</p>
        </div>
      </div>
    </div>
    
    <div class="signin-form-demo">
      <div class="form-field">
        <label>üìö Subject</label>
        <select id="subject" onchange="updateExample()" style="width: 100%; padding: 15px; font-size: 1.1em; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(255, 255, 255, 0.9); color: #333;">
          <option value="">Select a subject</option>
          <option value="math">Math</option>
          <option value="english">English</option>
          <option value="science">Science</option>
        </select>
      </div>
      
      <div class="form-field">
        <label>üéì Grade Level</label>
        <select id="grade" style="width: 100%; padding: 15px; font-size: 1.1em; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(255, 255, 255, 0.9); color: #333;">
          <option value="1">Grade 1</option>
          <option value="2">Grade 2</option>
          <option value="3">Grade 3</option>
          <option value="4">Grade 4</option>
          <option value="5">Grade 5</option>
          <option value="6">Grade 6</option>
          <option value="7">Grade 7</option>
          <option value="8">Grade 8</option>
          <option value="9">Grade 9</option>
          <option value="10">Grade 10</option>
          <option value="11">Grade 11</option>
          <option value="12">Grade 12</option>
        </select>
      </div>
      
      <div class="form-field">
        <label>‚úçÔ∏è Your Question</label>
        <textarea id="question" placeholder="Select a subject to see an example..." style="width: 100%; padding: 15px; font-size: 1.1em; border: 2px solid rgba(255, 255, 255, 0.3); border-radius: 10px; background: rgba(255, 255, 255, 0.2); color: white; min-height: 120px; resize: vertical;"></textarea>
      </div>

      <div class="form-field">
        <label>üì∏ Or Upload Homework Picture</label>
        <div style="position: relative;">
          <input type="file" id="imageUpload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
          <button type="button" onclick="document.getElementById('imageUpload').click()" style="width: 100%; padding: 15px; font-size: 1.1em; border: 2px dashed rgba(255, 255, 255, 0.5); border-radius: 10px; background: rgba(255, 255, 255, 0.1); color: white; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;">
            <span style="font-size: 2em;">üì∑</span>
            <span>Click to upload image</span>
          </button>
          <div id="imagePreview" style="display: none; margin-top: 15px; text-align: center;">
            <img id="previewImg" style="max-width: 100%; max-height: 300px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
            <p id="imageName" style="margin-top: 10px; font-size: 0.9em; color: #fff;"></p>
          </div>
        </div>
      </div>
      
      <button class="demo-button" onclick="getAnswer()">Get Answer üöÄ</button>
      
      <div id="answer-section" style="display: none; margin-top: 30px; padding: 30px; background: rgba(255, 255, 255, 0.95); border-radius: 15px; text-align: left; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);">
        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.5em;">üí° Solution:</h3>
        <p id="solution" style="font-size: 1.4em; color: #333; margin-bottom: 25px; font-weight: bold; background: #f0f0f0; padding: 15px; border-radius: 8px;"></p>
        <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.5em;">üìñ Explanation:</h3>
        <p id="explanation" style="font-size: 1.2em; color: #333; white-space: pre-wrap; line-height: 1.8; background: #f9f9f9; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea;"></p>
      </div>
    </div>
    
    <!-- Question History Section -->
    <div style="margin-top: 30px; max-width: 900px; width: 100%;">
      <button class="demo-button" onclick="toggleHistory()" style="width: auto; margin-bottom: 20px;">
        üìö View Question History (<span id="historyCount">0</span>)
      </button>
      
      <div id="history-section" style="display: none; padding: 25px; background: rgba(255, 255, 255, 0.95); border-radius: 15px; text-align: left; max-height: 400px; overflow-y: auto;">
        <h3 style="color: #667eea; margin-bottom: 15px;">Past Questions & Answers</h3>
        <div id="history-list" style="font-size: 1em; color: #333;">
          <p style="text-align: center; color: #999;">No questions yet. Start asking!</p>
        </div>
      </div>
    </div>
    
    <div style="margin-top: 30px; display: flex; gap: 30px; justify-content: center; flex-wrap: wrap;">
      <p style="font-size: 1.2em;">‚úì Natural language support</p>
      <p style="font-size: 1.2em;">‚úì Upload homework photos</p>
      <p style="font-size: 1.2em;">‚úì Detailed explanations</p>
      <p style="font-size: 1.2em;">‚úì Step-by-step solutions</p>
    </div>
  </div>

  <!-- Slide 3: Teacher Dashboard -->
  <div class="slide" id="teacherSlide" style="display: none;">
    <h1>üë®‚Äçüè´ Teacher Dashboard</h1>
    <h2>Manage Your Students</h2>
    
    <div style="max-width: 1200px; width: 100%; margin-top: 30px;">
      <div class="feature-grid">
        <div class="feature-card">
          <h3>üìä Student Activity</h3>
          <p style="font-size: 1.2em; margin-top: 15px;">View all student questions and answers in real-time</p>
          <button class="demo-button" style="margin-top: 20px;">View Students</button>
        </div>
        
        <div class="feature-card">
          <h3>üìù Create Assignment</h3>
          <p style="font-size: 1.2em; margin-top: 15px;">Assign homework to your students</p>
          <button class="demo-button" style="margin-top: 20px;">New Assignment</button>
        </div>
        
        <div class="feature-card">
          <h3>üìà Analytics</h3>
          <p style="font-size: 1.2em; margin-top: 15px;">Track student progress and performance</p>
          <button class="demo-button" style="margin-top: 20px;">View Stats</button>
        </div>
      </div>
      const role = localStorage.getItem('userRole') || 'student';
      updateSlideVisibility(role);
      setTimeout(() => {
        alert('‚úÖ Welcome back' + (email ? ', ' + email : '') + '! You are signed in as ' + role + 'radius: 15px;">
        <h3>Recent Student Questions</h3>
        <div style="margin-top: 20px; text-align: left; font-size: 1.1em;">
          <p>‚Ä¢ John D. - Math: "What is 2x + 5 = 13?" - <span style="color: #90EE90;">Answered</span></p>
          <p>‚Ä¢ Sarah M. - English: "What is an adverb?" - <span style="color: #90EE90;">Answered</span></p>
          <p>‚Ä¢ Mike L. - Science: "What is photosynthesis?" - <span style="color: #90EE90;">Answered</span></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Slide 3: Admin Dashboard -->
  <div class="slide" id="adminSlide" style="display: none;">
    <h1>‚öôÔ∏è Admin Dashboard</h1>
    <h2>System Management</h2>
    
    <div style="max-width: 1400px; width: 100%; margin-top: 30px;">
      <div class="feature-grid">
        <div class="feature-card">
          <h3>üë• User Management</h3>
          <p style="font-size: 3em; margin: 15px 0;">156</p>
          <p style="font-size: 1.1em;">Total Users</p>
          <button class="demo-button" style="margin-top: 15px;">Manage Users</button>
        </div>
        
        <div class="feature-card">
          <h3>üí∞ Revenue</h3>
          <p style="font-size: 3em; margin: 15px 0;">$2,340</p>
          <p style="font-size: 1.1em;">This Month</p>
          <button class="demo-button" style="margin-top: 15px;">View Details</button>
        </div>
        
        <div class="feature-card">
          <h3>üìä Activity</h3>
          <p style="font-size: 3em; margin: 15px 0;">1,243</p>
          <p style="font-size: 1.1em;">Questions Today</p>
          <button class="demo-button" style="margin-top: 15px;">View Logs</button>
        </div>
        
        <div class="feature-card">
          <h3>ü§ñ AI Usage</h3>
          <p style="font-size: 3em; margin: 15px 0;">87%</p>
          <p style="font-size: 1.1em;">AI vs Pattern</p>
          <button class="demo-button" style="margin-top: 15px;">API Stats</button>
        </div>
      </div>
      
      <div style="margin-top: 40px; padding: 30px; background: rgba(255, 255, 255, 0.15); border-radius: 15px;">
        <h3>System Settings</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
          <button class="demo-button">Change Pricing</button>
          <button class="demo-button">Manage Teachers</button>
          <button class="demo-button">View All Activity</button>
          <button class="demo-button">Export Data</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation Controls -->
  <div class="controls">
    <button onclick="previousSlide()">‚óÄ Previous</button>
    <button onclick="nextSlide()">Next ‚ñ∂</button>
  </div>

  <div class="slide-number">
    <span id="currentSlide">1</span> / <span id="totalSlides">3</span>
  </div>

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
  </div>

  <script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = 3; // Fixed to 3 slides (homepage, signin, dashboard)
    let isSignedIn = localStorage.getItem('isSignedIn') === 'true';

    document.getElementById('totalSlides').textContent = totalSlides;
    
    // Load and display progress stats
    function updateProgressStats() {
      const history = JSON.parse(localStorage.getItem('questionHistory') || '[]');
      const mathQuestions = history.filter(q => q.subject === 'math').length;
      const englishQuestions = history.filter(q => q.subject === 'english').length;
      const scienceQuestions = history.filter(q => q.subject === 'science').length;
      
      document.getElementById('totalQuestions').textContent = history.length;
      document.getElementById('mathCount').textContent = mathQuestions;
      document.getElementById('englishCount').textContent = englishQuestions;
      document.getElementById('scienceCount').textContent = scienceQuestions;
      document.getElementById('historyCount').textContent = history.length;
    }
    
    // Toggle history visibility
    function toggleHistory() {
      const historySection = document.getElementById('history-section');
      if (historySection.style.display === 'none') {
        historySection.style.display = 'block';
        loadHistory();
      } else {
        historySection.style.display = 'none';
      }
    }
    
    // Load question history
    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('questionHistory') || '[]');
      const historyList = document.getElementById('history-list');
      
      if (history.length === 0) {
        historyList.innerHTML = '<p style="text-align: center; color: #999;">No questions yet. Start asking!</p>';
        return;
      }
      
      // Sort by newest first
      history.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      let html = '';
      history.forEach((item, index) => {
        const date = new Date(item.timestamp).toLocaleDateString();
        const time = new Date(item.timestamp).toLocaleTimeString();
        const subjectEmoji = item.subject === 'math' ? 'üî¢' : item.subject === 'english' ? 'üìù' : 'üî¨';
        
        html += `
          <div style="margin-bottom: 15px; padding: 15px; background: #f0f0f0; border-radius: 10px; border-left: 4px solid #667eea;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <strong>${subjectEmoji} ${item.subject.toUpperCase()} - Grade ${item.grade}</strong>
              <span style="color: #666; font-size: 0.9em;">${date} ${time}</span>
            </div>
            <p style="margin: 8px 0; font-weight: 600; color: #333;"><strong>Q:</strong> ${item.question}</p>
            <p style="margin: 8px 0; color: #555;"><strong>A:</strong> ${item.solution}</p>
            ${item.usedImage ? '<span style="background: #e3f2fd; padding: 3px 8px; border-radius: 5px; font-size: 0.85em;">üì∑ Image</span>' : ''}
          </div>
        `;
      });
      
      historyList.innerHTML = html;
    }
    
    // Update stats when page loads
    if (isSignedIn && localStorage.getItem('userRole') === 'student') {
      setTimeout(updateProgressStats, 500);
    }
    
    // Show auto sign-in notification if already signed in
    if (isSignedIn) {
      const email = localStorage.getItem('userEmail');
      const role = localStorage.getItem('userRole') || 'student';
      updateSlideVisibility(role);
      setTimeout(() => {
        alert('‚úÖ Welcome back' + (email ? ', ' + email : '') + '! You are signed in as ' + role + '.');
      }, 500);
    }

    function showSlide(n) {
      // Check if trying to access slide 3 (questions) without sign-in
      if (n === 2 && !isSignedIn) {
        alert('‚ö†Ô∏è Please sign in first to ask questions!');
        return;
      }

      // Skip sign-in page if already signed in
      if (n === 1 && isSignedIn) {
        // Moving from slide 1 to 2, but already signed in - skip to slide 3
        if (currentSlide === 0) {
          n = 2;
        }
      }

      // Hide current slide
      if (currentSlide === 0) {
        slides[0].classList.remove('active');
      } else if (currentSlide === 1) {
        slides[1].classList.remove('active');
      } else if (currentSlide === 2) {
        // Hide all dashboard slides
        document.getElementById('studentSlide').classList.remove('active');
        document.getElementById('teacherSlide').classList.remove('active');
        document.getElementById('adminSlide').classList.remove('active');
      }

      currentSlide = (n + totalSlides) % totalSlides;
      
      // Show new slide
      if (currentSlide === 0) {
        slides[0].classList.add('active');
      } else if (currentSlide === 1) {
        slides[1].classList.add('active');
      } else if (currentSlide === 2) {
        // Show appropriate dashboard based on role
        const role = localStorage.getItem('userRole') || 'student';
        if (role === 'teacher') {
          document.getElementById('teacherSlide').classList.add('active');
        } else if (role === 'admin') {
          document.getElementById('adminSlide').classList.add('active');
        } else {
          document.getElementById('studentSlide').classList.add('active');
        }
      }
      
      document.getElementById('currentSlide').textContent = currentSlide + 1;
      
      // Update progress bar
      const progress = ((currentSlide + 1) / totalSlides) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    function nextSlide() {
      showSlide(currentSlide + 1);
    }

    function previousSlide() {
      showSlide(currentSlide - 1);
    }

    // Arrow keys only navigation
    document.addEventListener('keydown', (e) => {
      // Check if user is typing in an input field
      const isTyping = document.activeElement.tagName === 'INPUT' || 
                       document.activeElement.tagName === 'TEXTAREA' ||
                       document.activeElement.tagName === 'SELECT';
      
      if (e.key === 'ArrowRight') {
        nextSlide();
      } else if (e.key === 'ArrowLeft') {
        previousSlide();
      } else if (e.key === 'Enter' && !isTyping) {
        // Enter key moves to next slide when not typing
        nextSlide();
      }
    });

    // Sign up button functionality
    function handleSignUp() {
      const email = document.querySelector('input[type="email"]').value;
      const password = document.getElementById('password-field').value;
      const role = document.getElementById('role').value;
      
      if (email && password) {
        isSignedIn = true;
        // Save to localStorage for auto sign-in
        localStorage.setItem('isSignedIn', 'true');
        localStorage.setItem('userEmail', email);
        localStorage.setItem('userRole', role);
        
        // Show role-specific slides
        updateSlideVisibility(role);
        
        alert('‚úÖ Sign up successful as ' + role + '!');
        nextSlide(); // Move to next slide
      } else {
        alert('Please fill in email and password');
      }
    }
    
    // Update which slide 3 is visible based on role
    function updateSlideVisibility(role) {
      const studentSlide = document.getElementById('studentSlide');
      const teacherSlide = document.getElementById('teacherSlide');
      const adminSlide = document.getElementById('adminSlide');
      
      // Hide all role-specific slides first
      studentSlide.style.display = 'none';
      teacherSlide.style.display = 'none';
      adminSlide.style.display = 'none';
      
      // Remove active class from all
      studentSlide.classList.remove('active');
      teacherSlide.classList.remove('active');
      adminSlide.classList.remove('active');
      
      // Show the appropriate one
      if (role === 'teacher') {
        teacherSlide.style.display = 'flex';
      } else if (role === 'admin') {
        adminSlide.style.display = 'flex';
    
    // Load and display progress stats
    function updateProgressStats() {
      const history = JSON.parse(localStorage.getItem('questionHistory') || '[]');
      const mathQuestions = history.filter(q => q.subject === 'math').length;
      const englishQuestions = history.filter(q => q.subject === 'english').length;
      const scienceQuestions = history.filter(q => q.subject === 'science').length;
      
      document.getElementById('totalQuestions').textContent = history.length;
      document.getElementById('mathCount').textContent = mathQuestions;
      document.getElementById('englishCount').textContent = englishQuestions;
      document.getElementById('scienceCount').textContent = scienceQuestions;
      document.getElementById('historyCount').textContent = history.length;
    }
    
    // Toggle history visibility
    function toggleHistory() {
      const historySection = document.getElementById('history-section');
      if (historySection.style.display === 'none') {
        historySection.style.display = 'block';
        loadHistory();
      } else {
        historySection.style.display = 'none';
      }
    }
    
    // Load question history
    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('questionHistory') || '[]');
      const historyList = document.getElementById('history-list');
      
      if (history.length === 0) {
        historyList.innerHTML = '<p style="text-align: center; color: #999;">No questions yet. Start asking!</p>';
        return;
      }
      
      // Sort by newest first
      history.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      let html = '';
      history.forEach((item, index) => {
        const date = new Date(item.timestamp).toLocaleDateString();
        const time = new Date(item.timestamp).toLocaleTimeString();
        const subjectEmoji = item.subject === 'math' ? 'üî¢' : item.subject === 'english' ? 'üìù' : 'üî¨';
        
        html += `
          <div style="margin-bottom: 15px; padding: 15px; background: #f0f0f0; border-radius: 10px; border-left: 4px solid #667eea;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <strong>${subjectEmoji} ${item.subject.toUpperCase()} - Grade ${item.grade}</strong>
              <span style="color: #666; font-size: 0.9em;">${date} ${time}</span>
            </div>
            <p style="margin: 8px 0; font-weight: 600; color: #333;"><strong>Q:</strong> ${item.question}</p>
            <p style="margin: 8px 0; color: #555;"><strong>A:</strong> ${item.solution}</p>
            ${item.usedImage ? '<span style="background: #e3f2fd; padding: 3px 8px; border-radius: 5px; font-size: 0.85em;">üì∑ Image</span>' : ''}
          </div>
        `;
      });
      
      historyList.innerHTML = html;
    }
    
    // Update stats when page loads
    if (isSignedIn && localStorage.getItem('userRole') === 'student') {
      setTimeout(updateProgressStats, 500);
    }
      } else {
        studentSlide.style.display = 'flex'

  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
  </div>

  <script>
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = 3; // Fixed to 3 slides (homepage, signin, dashboard)
    let isSignedIn = localStorage.getItem('isSignedIn') === 'true';

    document.getElementById('totalSlides').textContent = totalSlides;
    
    // Show auto sign-in notification if already signed in
    if (isSignedIn) {
      const email = localStorage.getItem('userEmail');
      setTimeout(() => {
        alert('‚úÖ Welcome back' + (email ? ', ' + email : '') + '! You are automatically signed in.');
      }, 500);
    }

    function showSlide(n) {
      // Check if trying to access slide 3 (questions) without sign-in
      if (n === 2 && !isSignedIn) {
        alert('‚ö†Ô∏è Please sign in first to ask questions!');
        return;
      }

      // Skip sign-in page if already signed in
      if (n === 1 && isSignedIn) {
        // Moving from slide 1 to 2, but already signed in - skip to slide 3
        if (currentSlide === 0) {
          n = 2;
        }
      }

      // Hide current slide
      if (currentSlide === 0) {
        slides[0].classList.remove('active');
      } else if (currentSlide === 1) {
        slides[1].classList.remove('active');
      } else if (currentSlide === 2) {
        // Hide all dashboard slides
        document.getElementById('studentSlide').classList.remove('active');
        document.getElementById('teacherSlide').classList.remove('active');
        document.getElementById('adminSlide').classList.remove('active');
      }

      currentSlide = (n + totalSlides) % totalSlides;
      
      // Show new slide
      if (currentSlide === 0) {
        slides[0].classList.add('active');
      } else if (currentSlide === 1) {
        slides[1].classList.add('active');
      } else if (currentSlide === 2) {
        // Show appropriate dashboard based on role
        const role = localStorage.getItem('userRole') || 'student';
        if (role === 'teacher') {
          document.getElementById('teacherSlide').classList.add('active');
        } else if (role === 'admin') {
          document.getElementById('adminSlide').classList.add('active');
        } else {
          document.getElementById('studentSlide').classList.add('active');
        }
      }
      
      document.getElementById('currentSlide').textContent = currentSlide + 1;
      
      // Update progress bar
      const progress = ((currentSlide + 1) / totalSlides) * 100;
      document.getElementById('progressFill').style.width = progress + '%';
    }

    function nextSlide() {
      showSlide(currentSlide + 1);
    }

    function previousSlide() {
      showSlide(currentSlide - 1);
    }

    // Arrow keys only navigation
    document.addEventListener('keydown', (e) => {
      // Check if user is typing in an input field
      const isTyping = document.activeElement.tagName === 'INPUT' || 
                       document.activeElement.tagName === 'TEXTAREA' ||
                       document.activeElement.tagName === 'SELECT';
      
      if (e.key === 'ArrowRight') {
        nextSlide();
      } else if (e.key === 'ArrowLeft') {
        previousSlide();
      } else if (e.key === 'Enter' && !isTyping) {
        // Enter key moves to next slide when not typing
        nextSlide();
      }
    });

    // Sign up button functionality
    function handleSignUp() {
      const email = document.querySelector('input[type="email"]').value;
      const password = document.getElementById('password-field').value;
      
      if (email && password) {
        isSignedIn = true;
        // Save to localStorage for auto sign-in
        localStorage.setItem('isSignedIn', 'true');
        localStorage.setItem('userEmail', email);
        alert('‚úÖ Sign up successful! You can now access the questions page.');
        nextSlide(); // Move to next slide
      } else {
        alert('Please fill in email and password');
      }
    }

    // Password visibility toggle
    function togglePassword() {
      const passwordField = document.getElementById('password-field');
      const icon = event.target;
      
      if (passwordField.type === 'password') {
        passwordField.type = 'text';
        icon.textContent = 'üôà';
      } else {
        passwordField.type = 'password';
        icon.textContent = 'üëÅÔ∏è';
      }
    }

    // Subject examples
    const subjectExamples = {
      'math': 'Example: What is 2x + 5 = 13?',
      'english': 'Example: What is an adverb?',
      'science': 'Example: What is Newton\'s first law?'
    };

    // Store uploaded image
    let uploadedImage = null;

    // Handle image upload
    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (!file) return;

      // Show preview
      const reader = new FileReader();
      reader.onload = function(e) {
        const previewDiv = document.getElementById('imagePreview');
        const previewImg = document.getElementById('previewImg');
        const imageName = document.getElementById('imageName');
        
        previewImg.src = e.target.result;
        imageName.textContent = file.name;
        previewDiv.style.display = 'block';
        
        // Store for submission
        uploadedImage = {
          name: file.name,
          data: e.target.result.split(',')[1], // Base64 data without prefix
          mimeType: file.type
        };
      };
      re  
          // Save to question history
          const history = JSON.parse(localStorage.getItem('questionHistory') || '[]');
          history.push({
            timestamp: new Date().toISOString(),
            subject: subject,
            grade: grade,
            question: uploadedImage ? (question || 'Image uploaded') : question,
            solution: data.data.solution,
            explanation: data.data.explanation,
            usedImage: !!uploadedImage,
            usedAI: data.data.usedAI || false
          });
          localStorage.setItem('questionHistory', JSON.stringify(history));
          
          // Update progress stats
          updateProgressStats();
          
          // Clear image after submission
          uploadedImage = null;
          document.getElementById('imagePreview').style.display = 'none';
          document.getElementById('imageUpload').value = '';
        ader.readAsDataURL(file);
    }

    // Update example when subject changes
    function updateExample() {
      const subject = document.getElementById('subject').value;
      const questionField = document.getElementById('question');
      
      if (subject && subjectExamples[subject]) {
        questionField.placeholder = subjectExamples[subject];
      } else {
        questionField.placeholder = 'Type your question here...';
      }
    }

    // Get Answer function
    async function getAnswer() {
      const subject = document.getElementById('subject').value;
      const grade = document.getElementById('grade').value;
      const question = document.getElementById('question').value;
      const answerSection = document.getElementById('answer-section');
      const solutionEl = document.getElementById('solution');
      const explanationEl = document.getElementById('explanation');
      
      // Validate subject selection
      if (!subject) {
        alert('‚ö†Ô∏è Please select a subject first!');
        return;
      }

      // Check if we have either text question or image
      if (!question.trim() && !uploadedImage) {
        alert('Please enter a question or upload an image');
        return;
      }

      // Show loading state immediately
      answerSection.style.display = 'block';
      solutionEl.innerHTML = '<div style="text-align:center;padding:20px"><div style="display:inline-block;width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #007bff;border-radius:50%;animation:spin 1s linear infinite"></div><p style="margin-top:12px;color:#666">' + (uploadedImage ? 'Analyzing image...' : 'Finding answer...') + '</p></div>';
      explanationEl.textContent = '';

      try {
        let endpoint = '/api/solve';
        let requestBody;
        let requestOptions = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        };

        // If image is uploaded, use image endpoint
        if (uploadedImage) {
          endpoint = '/api/solve-image';
          requestBody = JSON.stringify({
            subject: subject,
            grade: grade,
            image: uploadedImage.data,
            mimeType: uploadedImage.mimeType,
            question: question || '' // Optional additional context
          });
        } else {
          // Text question only
          requestBody = JSON.stringify({
            subject: subject,
            grade: grade,
            problem: question
          });
        }

        requestOptions.body = requestBody;
        const response = await fetch(endpoint, requestOptions);

        const data = await response.json();

        if (data.success) {
          // Display results immediately
          solutionEl.textContent = data.data.solution;
          explanationEl.textContent = data.data.explanation;
        } else {
          solutionEl.textContent = '‚ùå Error';
          explanationEl.textContent = data.error || 'Failed to get answer';
        }
      } catch (error) {
        solutionEl.textContent = '‚ùå Connection Error';
        explanationEl.textContent = 'Could not connect to server. Make sure the server is running.';
        console.error(error);
      }
    }
  </script>
</body>
</html>
